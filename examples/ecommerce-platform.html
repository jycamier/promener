<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E-Commerce Platform Metrics - Metrics Documentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class'
        }
    </script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <style>
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900" x-data="metricsApp()">
    
    <header class="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex justify-between items-center">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900 dark:text-white">E-Commerce Platform Metrics</h1>
                    <p class="text-sm text-gray-600 dark:text-gray-400">Version 2.0.0</p>
                </div>
                <div class="flex items-center gap-4">
                    
                    
                    <select
                        x-model="selectedService"
                        class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"
                        x-cloak
                    >
                        <template x-for="service in services">
                            <option :value="service.name" :selected="service.name === selectedService" x-text="service.info.title"></option>
                        </template>
                    </select>
                    
                    
                    <input
                        type="text"
                        x-model="search"
                        placeholder="Search metrics..."
                        class="px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"
                    >
                    
                    <button
                        @click="toggleDarkMode()"
                        class="p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700"
                    >
                        <span x-show="darkMode">üåô</span>
                        <span x-show="!darkMode">‚òÄÔ∏è</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    
    
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4">
            <template x-for="service in services" :key="service.name">
                <div x-show="selectedService === service.name">
                    <div class="flex items-center justify-between mb-2">
                        <div>
                            <h2 class="text-lg font-semibold text-gray-900 dark:text-white" x-text="service.info.title"></h2>
                            <p class="text-sm text-gray-600 dark:text-gray-400" x-text="service.info.description"></p>
                        </div>
                        <span class="text-sm text-gray-500 dark:text-gray-400">v<span x-text="service.info.version"></span></span>
                    </div>
                    <div x-show="service.servers && service.servers.length > 0" class="mt-3">
                        <h3 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">Servers</h3>
                        <div class="space-y-2">
                            <template x-for="server in service.servers" :key="server.url">
                                <div class="flex items-center gap-2">
                                    <code class="px-3 py-1 bg-blue-50 dark:bg-blue-900 rounded text-sm font-mono text-blue-800 dark:text-blue-200" x-text="server.url"></code>
                                    <span class="text-sm text-gray-500 dark:text-gray-400" x-show="server.description" x-text="'- ' + server.description"></span>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>
            </template>
        </div>
    </div>
    

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="grid grid-cols-1 lg:grid-cols-5 gap-8">
            
            <nav class="lg:col-span-2">
                <div class="sticky top-24 bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 overflow-y-auto" style="max-height: calc(100vh - 7rem);">
                    <div class="space-y-2" x-data="{ openNamespaces: {} }">
                        <template x-for="(subsystems, namespace) in groupedMetrics" :key="namespace">
                            <div>
                                <button
                                    @click="openNamespaces[namespace] = !openNamespaces[namespace]"
                                    class="w-full flex items-center justify-between text-sm font-bold text-gray-900 dark:text-white uppercase tracking-wide py-2 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700 sticky top-0 bg-white dark:bg-gray-800 z-10"
                                    :class="{ 'mb-2': openNamespaces[namespace] }"
                                >
                                    <span x-text="namespace"></span>
                                    <svg class="w-4 h-4 transition-transform" :class="{ 'rotate-180': openNamespaces[namespace] }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                    </svg>
                                </button>
                                <div x-show="openNamespaces[namespace]" x-collapse>
                                    <template x-for="(metrics, subsystem) in subsystems" :key="namespace + subsystem">
                                        <div class="ml-2 mb-3" x-data="{ open: true }">
                                            <button
                                                @click="open = !open"
                                                class="w-full flex items-center justify-between text-sm font-semibold text-gray-700 dark:text-gray-300 py-1 px-2 rounded hover:bg-gray-100 dark:hover:bg-gray-700"
                                            >
                                                <span x-text="subsystem"></span>
                                                <svg class="w-3 h-3 transition-transform" :class="{ 'rotate-180': open }" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                                </svg>
                                            </button>
                                            <ul class="ml-2 space-y-1 mt-1" x-show="open" x-collapse>
                                                <template x-for="metric in metrics" :key="metric.fullName">
                                                    <li>
                                                        <a
                                                            :href="'#' + metric.fullName"
                                                            class="block px-2 py-1 rounded text-xs hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-600 dark:text-gray-400 truncate"
                                                            :title="metric.fullName"
                                                            x-text="metric.name"
                                                        ></a>
                                                    </li>
                                                </template>
                                            </ul>
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>
            </nav>

            
            <main class="lg:col-span-3">
                <template x-for="metric in filteredMetrics" :key="metric.fullName">
                    <div
                        :id="metric.fullName"
                        class="bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 mb-6"
                    >
                        
                        <div class="mb-4">
                            <div class="flex items-start justify-between">
                                <div>
                                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white" x-text="metric.fullName"></h3>
                                    <span
                                        class="inline-block px-2 py-1 text-xs font-semibold rounded mt-2"
                                        :class="{
                                            'bg-blue-100 text-blue-800': metric.type === 'counter',
                                            'bg-green-100 text-green-800': metric.type === 'gauge',
                                            'bg-purple-100 text-purple-800': metric.type === 'histogram',
                                            'bg-yellow-100 text-yellow-800': metric.type === 'summary'
                                        }"
                                        x-text="metric.type.toUpperCase()"
                                    ></span>
                                </div>
                            </div>
                            <p class="text-gray-600 dark:text-gray-400 mt-2" x-text="metric.help"></p>
                        </div>

                        
                        <div class="mb-4" x-show="metric.labels.length > 0">
                            <h4 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">Labels</h4>
                            <div class="space-y-2">
                                <template x-for="label in metric.labels" :key="label.name">
                                    <div>
                                        <code class="px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-sm font-mono text-gray-800 dark:text-gray-200" x-text="label.name"></code>
                                        <p class="ml-2 mt-1 text-sm text-gray-600 dark:text-gray-400" x-show="label.description" x-text="label.description"></p>
                                    </div>
                                </template>
                            </div>
                        </div>

                        
                        <div class="mb-4" x-show="metric.constLabels && metric.constLabels.length > 0">
                            <h4 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">Constant Labels</h4>
                            <div class="space-y-2">
                                <template x-for="label in metric.constLabels" :key="label.name">
                                    <div>
                                        <div class="flex items-center gap-2">
                                            <code class="px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded text-sm font-mono text-gray-800 dark:text-gray-200" x-text="label.name"></code>
                                            <span class="text-sm text-gray-500 dark:text-gray-500">=</span>
                                            <code class="px-2 py-1 bg-blue-50 dark:bg-blue-900 rounded text-sm font-mono text-blue-800 dark:text-blue-200" x-text="label.value"></code>
                                        </div>
                                        <p class="ml-2 mt-1 text-sm text-gray-600 dark:text-gray-400" x-show="label.description" x-text="label.description"></p>
                                    </div>
                                </template>
                            </div>
                        </div>

                        
                        <div x-show="metric.examples && (metric.examples.promql || metric.examples.alerts)" x-data="{ activeTab: 'promql' }">
                            <h4 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">Examples</h4>

                            
                            <div class="border-b border-gray-200 dark:border-gray-700 mb-4">
                                <nav class="flex space-x-4">
                                    <button
                                        @click="activeTab = 'promql'"
                                        :class="activeTab === 'promql' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                                        class="py-2 px-1 border-b-2 font-medium text-sm"
                                        x-show="metric.examples.promql && metric.examples.promql.length > 0"
                                    >
                                        PromQL
                                    </button>
                                    <button
                                        @click="activeTab = 'alerts'"
                                        :class="activeTab === 'alerts' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                                        class="py-2 px-1 border-b-2 font-medium text-sm"
                                        x-show="metric.examples.alerts && metric.examples.alerts.length > 0"
                                    >
                                        Alerts
                                    </button>
                                </nav>
                            </div>

                            
                            <div x-show="activeTab === 'promql' && metric.examples.promql" class="space-y-4">
                                <template x-for="example in metric.examples.promql" :key="example.query">
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-4">
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-2" x-show="example.description" x-text="example.description"></p>
                                        <div class="relative">
                                            <pre class="bg-gray-900 text-gray-100 p-4 rounded overflow-x-auto text-sm"><code x-text="example.query"></code></pre>
                                            <button
                                                @click="copyToClipboard(example.query)"
                                                class="absolute top-2 right-2 px-3 py-1 bg-gray-700 hover:bg-gray-600 text-white text-xs rounded"
                                            >
                                                Copy
                                            </button>
                                        </div>
                                    </div>
                                </template>
                            </div>

                            
                            <div x-show="activeTab === 'alerts' && metric.examples.alerts" class="space-y-4">
                                <template x-for="example in metric.examples.alerts" :key="example.name">
                                    <div class="bg-gray-50 dark:bg-gray-900 rounded-lg p-4">
                                        <div class="flex items-center justify-between mb-2">
                                            <h5 class="font-semibold text-gray-900 dark:text-white" x-text="example.name"></h5>
                                            <span
                                                class="px-2 py-1 text-xs font-semibold rounded"
                                                :class="{
                                                    'bg-red-100 text-red-800': example.severity === 'critical',
                                                    'bg-orange-100 text-orange-800': example.severity === 'warning',
                                                    'bg-blue-100 text-blue-800': example.severity === 'info'
                                                }"
                                                x-show="example.severity"
                                                x-text="example.severity"
                                            ></span>
                                        </div>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-2" x-show="example.description" x-text="example.description"></p>
                                        <p class="text-sm text-gray-600 dark:text-gray-400 mb-2" x-show="example.for">
                                            For: <span x-text="example.for"></span>
                                        </p>
                                        <div class="relative">
                                            <pre class="bg-gray-900 text-gray-100 p-4 rounded overflow-x-auto text-sm"><code x-text="example.expr"></code></pre>
                                            <button
                                                @click="copyToClipboard(example.expr)"
                                                class="absolute top-2 right-2 px-3 py-1 bg-gray-700 hover:bg-gray-600 text-white text-xs rounded"
                                            >
                                                Copy
                                            </button>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </div>
                    </div>
                </template>

                <div x-show="filteredMetrics.length === 0" class="text-center py-12">
                    <p class="text-gray-500 dark:text-gray-400">No metrics found matching your search.</p>
                </div>
            </main>
        </div>
    </div>

    <script>
        function metricsApp() {
            
            const savedMode = localStorage.getItem('darkMode');
            const initialDarkMode = savedMode !== null
                ? savedMode === 'true'
                : window.matchMedia('(prefers-color-scheme: dark)').matches;

            
            const services = [{"name":"api-gateway","info":{"Title":"API Gateway","Description":"Kong API Gateway - G√®re l'authentification, rate limiting et routing","Version":"3.2.0","Package":"ApiGateway.Metrics"},"servers":[{"url":"https://api.shopnow.com/metrics","description":"Production"},{"url":"https://api-staging.shopnow.com/metrics","description":"Staging"},{"url":"http://localhost:8080/metrics","description":"Local development"}],"metrics":[{"fullName":"gateway_http_http_requests_total","name":"http_requests_total","namespace":"gateway","subsystem":"http","type":"counter","help":"Total HTTP requests through gateway","labels":[{"name":"status_code","description":"HTTP status code"},{"name":"service","description":"Target microservice"},{"name":"route","description":"API route pattern"},{"name":"method","description":"HTTP method (GET, POST, PUT, DELETE)"}],"examples":{"promql":[{"query":"rate(gateway_http_requests_total[5m])","description":"Request rate per second"},{"query":"sum by (service) (rate(gateway_http_requests_total[5m]))","description":"Request rate by service"}],"alerts":[{"name":"HighGatewayErrorRate","expr":"rate(gateway_http_requests_total{status_code=~\"5..\"}[5m]) / rate(gateway_http_requests_total[5m]) \u003e 0.01","description":"Gateway error rate above 1%","for":"5m","severity":"critical"}]}},{"fullName":"gateway_http_http_request_duration_seconds","name":"http_request_duration_seconds","namespace":"gateway","subsystem":"http","type":"histogram","help":"HTTP request latency in seconds","labels":[{"name":"method","description":"HTTP method"},{"name":"service","description":"Target microservice"}],"examples":{"promql":[{"query":"histogram_quantile(0.95, rate(gateway_http_request_duration_seconds_bucket[5m]))","description":"95th percentile latency"}],"alerts":[{"name":"HighGatewayLatency","expr":"histogram_quantile(0.95, rate(gateway_http_request_duration_seconds_bucket[5m])) \u003e 1","description":"P95 latency above 1 second","for":"10m","severity":"warning"}]}},{"fullName":"gateway_ratelimit_rate_limit_exceeded_total","name":"rate_limit_exceeded_total","namespace":"gateway","subsystem":"ratelimit","type":"counter","help":"Number of rate limit exceeded events","labels":[{"name":"client_id","description":"Client identifier"},{"name":"endpoint","description":"API endpoint"}]}]},{"name":"user-service","info":{"Title":"User Service","Description":"Service de gestion des utilisateurs et authentification","Version":"2.1.5","Package":"UserService.Metrics"},"servers":[{"url":"https://users.shopnow.com/metrics","description":"Production"},{"url":"http://localhost:8081/metrics","description":"Local"}],"metrics":[{"fullName":"users_accounts_user_registrations_total","name":"user_registrations_total","namespace":"users","subsystem":"accounts","type":"counter","help":"Total user registrations","labels":[{"name":"registration_type","description":"Type (email, google, facebook, apple)"},{"name":"country","description":"User country code"}],"examples":{"promql":[{"query":"rate(users_accounts_user_registrations_total[1h])","description":"Registration rate per hour"},{"query":"sum by (registration_type) (users_accounts_user_registrations_total)","description":"Registrations by type"}]}},{"fullName":"users_auth_login_attempts_total","name":"login_attempts_total","namespace":"users","subsystem":"auth","type":"counter","help":"Total login attempts","labels":[{"name":"status","description":"Status (success, failed, blocked)"},{"name":"method","description":"Auth method (password, oauth, mfa)"}],"examples":{"alerts":[{"name":"HighLoginFailureRate","expr":"rate(users_auth_login_attempts_total{status=\"failed\"}[5m]) \u003e 10","description":"More than 10 failed logins per second","for":"5m","severity":"warning"}]}},{"fullName":"users_sessions_active_sessions","name":"active_sessions","namespace":"users","subsystem":"sessions","type":"gauge","help":"Number of active user sessions","labels":[{"name":"device_type","description":"Device (mobile, desktop, tablet)"}]}]},{"name":"product-service","info":{"Title":"Product Catalog Service","Description":"Service de gestion du catalogue produits","Version":"1.8.2","Package":"ProductService.Metrics"},"servers":[{"url":"https://products.shopnow.com/metrics","description":"Production"},{"url":"http://localhost:8082/metrics","description":"Local"}],"metrics":[{"fullName":"products_catalog_product_views_total","name":"product_views_total","namespace":"products","subsystem":"catalog","type":"counter","help":"Total product page views","labels":[{"name":"category","description":"Product category"},{"name":"source","description":"Traffic source (search, recommendation, direct)"}]},{"fullName":"products_search_search_queries_total","name":"search_queries_total","namespace":"products","subsystem":"search","type":"counter","help":"Total product search queries","labels":[{"name":"result_count","description":"Results (0, 1-10, 11-50, 50+)"}],"examples":{"promql":[{"query":"rate(products_search_search_queries_total{result_count=\"0\"}[5m]) / rate(products_search_search_queries_total[5m])","description":"Zero-result search rate"}]}},{"fullName":"products_search_search_latency_seconds","name":"search_latency_seconds","namespace":"products","subsystem":"search","type":"histogram","help":"Product search latency","labels":[{"name":"index_type","description":"Search index (elasticsearch, algolia)"}]},{"fullName":"products_inventory_inventory_level","name":"inventory_level","namespace":"products","subsystem":"inventory","type":"gauge","help":"Current inventory level","labels":[{"name":"product_id","description":"Product SKU"},{"name":"warehouse","description":"Warehouse location"}],"examples":{"alerts":[{"name":"LowInventory","expr":"products_inventory_inventory_level \u003c 10","description":"Product inventory below 10 units","severity":"warning"}]}}]},{"name":"order-service","info":{"Title":"Order Management Service","Description":"Service de gestion du cycle de vie des commandes","Version":"2.5.1","Package":"OrderService.Metrics"},"servers":[{"url":"https://orders.shopnow.com/metrics","description":"Production"},{"url":"http://localhost:8083/metrics","description":"Local"}],"metrics":[{"fullName":"orders_lifecycle_orders_created_total","name":"orders_created_total","namespace":"orders","subsystem":"lifecycle","type":"counter","help":"Total orders created","labels":[{"name":"channel","description":"Sales channel (web, mobile, api)"},{"name":"country","description":"Shipping country"}],"examples":{"promql":[{"query":"rate(orders_lifecycle_orders_created_total[1h])","description":"Order creation rate per hour"}],"alerts":[{"name":"LowOrderRate","expr":"rate(orders_lifecycle_orders_created_total[1h]) \u003c 5","description":"Order rate below 5 per hour","for":"30m","severity":"warning"}]}},{"fullName":"orders_business_order_value_euros","name":"order_value_euros","namespace":"orders","subsystem":"business","type":"histogram","help":"Order value in euros","labels":[{"name":"currency","description":"Original currency"},{"name":"channel","description":"Sales channel"}],"examples":{"promql":[{"query":"sum(rate(orders_business_order_value_euros_sum[1h]))","description":"Revenue per hour in euros"},{"query":"histogram_quantile(0.50, rate(orders_business_order_value_euros_bucket[1h]))","description":"Median order value"}]}},{"fullName":"orders_processing_order_processing_duration_seconds","name":"order_processing_duration_seconds","namespace":"orders","subsystem":"processing","type":"histogram","help":"Time to process order","labels":[{"name":"status","description":"Final status (completed, cancelled, failed)"}]},{"fullName":"orders_cart_cart_abandonment_total","name":"cart_abandonment_total","namespace":"orders","subsystem":"cart","type":"counter","help":"Shopping cart abandonments","labels":[{"name":"stage","description":"Stage (cart, checkout, payment)"},{"name":"device_type","description":"Device type"}],"examples":{"promql":[{"query":"rate(orders_cart_cart_abandonment_total[1h]) / rate(orders_lifecycle_orders_created_total[1h])","description":"Cart abandonment rate"}]}}]},{"name":"payment-service","info":{"Title":"Payment Processing Service","Description":"Service de traitement des paiements via Stripe et PayPal","Version":"1.9.0","Package":"PaymentService.Metrics"},"servers":[{"url":"https://payments.shopnow.com/metrics","description":"Production"},{"url":"https://payments-staging.shopnow.com/metrics","description":"Staging"}],"metrics":[{"fullName":"payments_processor_payment_processing_duration_seconds","name":"payment_processing_duration_seconds","namespace":"payments","subsystem":"processor","type":"histogram","help":"Payment processing duration","labels":[{"name":"provider","description":"Payment provider"}],"examples":{"alerts":[{"name":"SlowPaymentProcessing","expr":"histogram_quantile(0.95, rate(payments_processor_payment_processing_duration_seconds_bucket[5m])) \u003e 10","description":"P95 payment processing time above 10 seconds","for":"10m","severity":"warning"}]}},{"fullName":"payments_refunds_refund_transactions_total","name":"refund_transactions_total","namespace":"payments","subsystem":"refunds","type":"counter","help":"Total refund transactions","labels":[{"name":"reason","description":"Refund reason (customer_request, fraud, error)"},{"name":"status","description":"Refund status"}]},{"fullName":"payments_processor_payment_transactions_total","name":"payment_transactions_total","namespace":"payments","subsystem":"processor","type":"counter","help":"Total payment transactions","labels":[{"name":"provider","description":"Payment provider (stripe, paypal, adyen)"},{"name":"method","description":"Payment method (card, bank_transfer, wallet)"},{"name":"status","description":"Transaction status (success, declined, error)"},{"name":"currency","description":"Transaction currency"}],"examples":{"promql":[{"query":"rate(payments_processor_payment_transactions_total{status=\"declined\"}[5m])","description":"Declined payment rate"}],"alerts":[{"name":"HighPaymentDeclineRate","expr":"rate(payments_processor_payment_transactions_total{status=\"declined\"}[5m]) / rate(payments_processor_payment_transactions_total[5m]) \u003e 0.10","description":"Payment decline rate above 10%","for":"15m","severity":"critical"}]}},{"fullName":"payments_processor_payment_amount_euros","name":"payment_amount_euros","namespace":"payments","subsystem":"processor","type":"histogram","help":"Payment amount in euros","labels":[{"name":"provider","description":"Payment provider"},{"name":"method","description":"Payment method"}]}]},{"name":"notification-service","info":{"Title":"Notification Service","Description":"Service d'envoi de notifications (email, SMS, push)","Version":"1.5.3","Package":"NotificationService.Metrics"},"servers":[{"url":"https://notifications.shopnow.com/metrics","description":"Production"},{"url":"http://localhost:8084/metrics","description":"Local"}],"metrics":[{"fullName":"notifications_delivery_notifications_sent_total","name":"notifications_sent_total","namespace":"notifications","subsystem":"delivery","type":"counter","help":"Total notifications sent","labels":[{"name":"channel","description":"Notification channel (email, sms, push, webhook)"},{"name":"template","description":"Template name"},{"name":"status","description":"Delivery status (sent, failed, bounced)"}],"examples":{"promql":[{"query":"rate(notifications_delivery_notifications_sent_total{status=\"failed\"}[5m])","description":"Failed notification rate"}],"alerts":[{"name":"HighNotificationFailureRate","expr":"rate(notifications_delivery_notifications_sent_total{status=\"failed\"}[5m]) / rate(notifications_delivery_notifications_sent_total[5m]) \u003e 0.05","description":"Notification failure rate above 5%","for":"10m","severity":"warning"}]}},{"fullName":"notifications_queue_notification_queue_size","name":"notification_queue_size","namespace":"notifications","subsystem":"queue","type":"gauge","help":"Number of notifications in queue","labels":[{"name":"priority","description":"Priority level (high, normal, low)"}],"examples":{"alerts":[{"name":"NotificationQueueBacklog","expr":"notifications_queue_notification_queue_size \u003e 10000","description":"More than 10k notifications in queue","for":"5m","severity":"warning"}]}},{"fullName":"notifications_email_email_delivery_duration_seconds","name":"email_delivery_duration_seconds","namespace":"notifications","subsystem":"email","type":"histogram","help":"Email delivery time","labels":[{"name":"provider","description":"Email provider (sendgrid, ses, mailgun)"}]}]}];
            const isMultiService = true;
            

            return {
                search: '',
                darkMode: initialDarkMode,
                
                isMultiService: true,
                services: services,
                selectedService: services.length > 0 ? services[0].name : null,
                

                get currentMetrics() {
                    
                    const service = this.services.find(s => s.name === this.selectedService);
                    return service ? service.metrics : [];
                    
                },

                get filteredMetrics() {
                    if (!this.search) return this.currentMetrics;
                    const query = this.search.toLowerCase();
                    return this.currentMetrics.filter(m =>
                        m.fullName.toLowerCase().includes(query) ||
                        m.help.toLowerCase().includes(query) ||
                        m.type.toLowerCase().includes(query)
                    );
                },

                get groupedMetrics() {
                    const grouped = {};
                    this.filteredMetrics.forEach(metric => {
                        if (!grouped[metric.namespace]) {
                            grouped[metric.namespace] = {};
                        }
                        if (!grouped[metric.namespace][metric.subsystem]) {
                            grouped[metric.namespace][metric.subsystem] = [];
                        }
                        grouped[metric.namespace][metric.subsystem].push(metric);
                    });
                    return grouped;
                },

                copyToClipboard(text) {
                    navigator.clipboard.writeText(text).then(() => {
                        alert('Copied to clipboard!');
                    });
                },

                toggleDarkMode() {
                    this.darkMode = !this.darkMode;
                    document.documentElement.classList.toggle('dark', this.darkMode);
                    localStorage.setItem('darkMode', this.darkMode);
                }
            }
        }

        
        (function() {
            const savedMode = localStorage.getItem('darkMode');
            const shouldBeDark = savedMode !== null
                ? savedMode === 'true'
                : window.matchMedia('(prefers-color-scheme: dark)').matches;

            if (shouldBeDark) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>
</body>
</html>
